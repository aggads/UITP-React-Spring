{"ast":null,"code":"import _objectSpread from \"C:\\\\Users\\\\aggad.samy\\\\Workspace\\\\uitp-service\\\\Front-end\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread\";\nvar _jsxFileName = \"C:\\\\Users\\\\aggad.samy\\\\Workspace\\\\uitp-service\\\\Front-end\\\\src\\\\components\\\\FormPage\\\\Mainform\\\\MainForm.js\";\nimport Frequency from './Frequency/Radio';\nimport Comments from './Comment/Comment'; // import Legend from './Legend/Legend';\n// import Motivation from './Motivation/Motivation2'\n\nimport Categories from './Categories/Categories';\nimport URLStorage from '../../../constants';\nimport { Link } from 'react-router-dom'; // import  ConfirmModal  from '../Modal';\n\nimport '../../../App.css';\nimport axios from 'axios';\nimport React from 'react';\nimport { Container, Row, Col, Button, Form, FormGroup, Label, Input } from 'reactstrap';\nimport './MainForm.css';\n\nconst Motivation = props => {\n  // axios.get(`${URLStorage.API_URL}/getallmotivations`)\n  //         .then(res => {\n  //             this.setState({ motivations: res.data });\n  //             localStorage.setItem(\"motivation\", JSON.stringify(res.data));\n  //         })\n  return React.createElement(FormGroup, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 27\n    },\n    __self: this\n  }, React.createElement(Label, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 28\n    },\n    __self: this\n  }, \"Motivation\"), React.createElement(Input, {\n    value: props.value,\n    onChange: props.parentCallback,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 29\n    },\n    __self: this\n  }, this.state.motivations.map(motivations => React.createElement(\"option\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 32\n    },\n    __self: this\n  }, motivations.motivation))));\n};\n\nexport default class MainForm extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      // --------- TESTING : UNCOMMENT WHEN SERVER DOWN ----------------\n      categories: [],\n      motivations: [],\n      regularity: [],\n      questions: [],\n      questionId: [],\n      id: 2,\n      // ----------------------------------------------------------------\n      answers: [],\n      value: [],\n      selectedCat: 1,\n      selectedMode: 0\n    };\n\n    this.handleSelection = idx => e => {\n      this.setState({\n        selectedMode: idx\n      });\n    };\n\n    this.next = () => {\n      this.setState(prevState => ({\n        selectedCat: prevState.selectedCat + 1\n      }));\n    };\n\n    this.prev = () => {\n      this.setState(prevState => ({\n        selectedCat: prevState.selectedCat - 1\n      }));\n    };\n\n    this.anyChange = id => e => {\n      const inputName = e.target.name;\n      const inputValue = e.target.value;\n      let entries = Object.assign({}, this.state);\n      const answers = entries.answers;\n      answers.map(answer => answer.questionID === id ? answer[inputName] = inputValue : undefined);\n      this.setState(entries);\n      localStorage.setItem(this.props.id, JSON.stringify(this.state.answers)); // ------------ SWITCH BOOLEAN TO COMPLETED FOR CURRENT MODE ---------------\n\n      if (this.state.answers.filter(answer => answer.frequency === null).length === 0) {\n        let completeMode = JSON.parse(localStorage.getItem(\"completedModes\"));\n        completeMode[this.props.index] = true;\n\n        if (this.props.group) {\n          var dummieArray = [];\n          completeMode.map(item => dummieArray.push(true));\n          localStorage.setItem(\"completedModes\", JSON.stringify(dummieArray));\n        } else {\n          localStorage.setItem(\"completedModes\", JSON.stringify(completeMode));\n        }\n      }\n    };\n\n    this.selectCat = e => {\n      this.setState({\n        selectedCat: e.target.value\n      });\n      localStorage.setItem(this.props.id, JSON.stringify(this.state.answers));\n    };\n  }\n\n  componentDidMount() {\n    const transportId = this.props.id;\n    this.setState({\n      modeID: transportId\n    }); // ------------ TESTING : UNCOMMENT WHEN SERVER DOWN -------\n    // const localanswers = localStorage.getItem(this.props.id);\n    // console.log(localanswers);\n    // this.setState({ answers: JSON.parse(localanswers)});\n    // console.log(\"localstorageanswers\", this.state.answers);\n    //-----------------------------------------------------------\n    // ------------ TESTING : COMMENT WHEN SERVER DOWN -------\n    // axios.get(`${URLStorage.API_URL}/getallresult`)\n    //     .then(res => {\n    //         if (res) {\n    //             const answers = res.data.map(function (item) {\n    //                 return {\n    //                     // question: item.question,\n    //                     // categoryId: item.id[0],\n    //                     // questionID: item.id[1],\n    //                     // motivationID: 6,\n    //                     // frequency: null,\n    //                     // modeID: transportId,\n    //                     idUser: item.idUser,\n    //                     frequency: item.idFrequency,\n    //                     motivation: item.idMotivation,\n    //                     question: item.idQuestion,\n    //                     comment: \"\",\n    //                     // periode: JSON.parse(localStorage.getItem(\"periods\")).currentPeriod,\n    //                     // previousPeriod: JSON.parse(localStorage.getItem(\"periods\")).previousPeriod,\n    //                 }\n    //             });\n    //             this.setState({ answers });\n    //             localStorage.setItem(this.props.id, JSON.stringify(answers));\n    //             if (!localStorage.getItem(this.props.id)) {\n    //                 this.setState({ answers });\n    //                 localStorage.setItem(this.props.id, JSON.stringify(this.state.answers));\n    //             } else {\n    //                 let ans1;\n    //                 ans1 = localStorage.getItem(this.props.id);\n    //                 this.setState({ answers: JSON.parse(ans1) });\n    //             }\n    //         }\n    //     })\n    //     .then(() => {\n    //         const localquestions = JSON.parse(localStorage.getItem(\"questions\"));\n    //         this.setState({ questions: localquestions });\n    //         let ans2;\n    //         ans2 = localStorage.getItem(this.props.id);\n    //         this.setState({ answers: JSON.parse(ans2) });\n    //     })\n\n    axios.get(\"\".concat(URLStorage.API_URL, \"/getallmotivations\")).then(res => {\n      this.setState({\n        motivations: res.data\n      });\n      localStorage.setItem(\"motivation\", JSON.stringify(res.data));\n    });\n    axios.get(\"\".concat(URLStorage.API_URL, \"/getallincident\")).then(res => {\n      const data = res.data;\n      this.setState({\n        categories: data,\n        isLoaded: true\n      });\n    }); // ------------------ Retreiving PREVIOUS PERIOD RESULTS ----------------------\n\n    if (JSON.parse(localStorage.getItem(\"periods\"))) {\n      axios.post(\"\".concat(URLStorage.API_URL, \"/resultPeriode\"), {\n        ptoID: parseInt(localStorage.getItem(\"ptoid\")),\n        periodeID: JSON.parse(localStorage.getItem(\"periods\")).previousPeriod\n      }).then(res => {\n        const previousResult = res.data.filter(item => item.mode_id === transportId).sort((a, b) => a.questionID - b.questionID).map(item => {\n          return {\n            prevFreq: item.frequency\n          };\n        });\n        const newStateAnswers = this.state.answers.map((answer, idx) => {\n          return _objectSpread({}, answer, previousResult[idx]);\n        }); // // ------------------ ADDING PREVIOUS PERIOD RESULTS TO THE STATE.ANSWERS ----------------------\n\n        this.setState({\n          answers: newStateAnswers\n        });\n        localStorage.setItem(\"prevResult\", JSON.stringify(previousResult));\n      });\n    }\n\n    ; // // -----------------------------------------------------------------\n\n    axios.get(\"\".concat(URLStorage.API_URL, \"/getallfrequency\")).then(res => {\n      const data = res.data;\n      this.setState({\n        regularity: data,\n        id: [],\n        isLoaded: true\n      });\n    });\n    axios.get(\"\".concat(URLStorage.API_URL, \"/getAllQuestions/\").concat(this.state.id)).then(res => {\n      const data = res.data;\n      this.setState({\n        questions: data,\n        isLoaded: true\n      });\n    }); // axios.get(`${URLStorage.API_URL}/getallquestions`)\n    // .then(res => {\n    //     const data = res.data\n    //     this.setState({\n    //         questions: data,\n    //         id:[],\n    //         isLoaded: true,\n    //     })\n    // })\n  }\n\n  render() {\n    // NEXT / SUBMIT BUTTON SWITCH\n    const nextSubmit = this.state.selectedCat === 5 ? // || (parseInt((localStorage.getItem(\"group\")) === 1)\n    JSON.parse(localStorage.getItem(\"completedModes\")).filter(item => item === false).length === 0 ? React.createElement(Link, {\n      to: {\n        pathname: \"/confirmation\",\n        state: {\n          answers: this.state.answers\n        }\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 250\n      },\n      __self: this\n    }, React.createElement(Button, {\n      onClick: this.submit,\n      className: \"submit\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 251\n      },\n      __self: this\n    }, \"Submit\")) : React.createElement(React.Fragment, null, React.createElement(Button, {\n      className: \"submit\",\n      disabled: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 254\n      },\n      __self: this\n    }, \"Submit\")) : React.createElement(Button, {\n      onClick: this.next,\n      className: \"submit\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 257\n      },\n      __self: this\n    }, \"Next\"); // async function getAnswers(){\n    //     const { answers } = await this.state;\n    // }\n    // getAnswers();\n\n    const answers = this.state.answers; //console.log(this.state.categories);\n    // console.log(this.state.regularity);\n    // console.log(this.state.motivations);\n\n    console.log(this.state.questions); // console.log(this.state.answers);\n    // console.log(this.state);\n\n    return React.createElement(React.Fragment, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 278\n      },\n      __self: this\n    }, React.createElement(Container, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 279\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      style: {\n        display: \"flex\",\n        justifyContent: \"flex-end\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 281\n      },\n      __self: this\n    }, this.state.selectedCat !== 1 && React.createElement(Button, {\n      style: {\n        marginRight: \"10px\"\n      },\n      onClick: this.prev,\n      className: \"submit\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 282\n      },\n      __self: this\n    }, \"Previous\"), nextSubmit), React.createElement(Categories, {\n      categories: this.state.categories,\n      parentCallback: this.selectCat,\n      active: this.state.selectedCat,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 285\n      },\n      __self: this\n    }), React.createElement(Motivation, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 289\n      },\n      __self: this\n    })));\n  }\n\n}","map":{"version":3,"sources":["C:\\Users\\aggad.samy\\Workspace\\uitp-service\\Front-end\\src\\components\\FormPage\\Mainform\\MainForm.js"],"names":["Frequency","Comments","Categories","URLStorage","Link","axios","React","Container","Row","Col","Button","Form","FormGroup","Label","Input","Motivation","props","value","parentCallback","state","motivations","map","motivation","MainForm","Component","categories","regularity","questions","questionId","id","answers","selectedCat","selectedMode","handleSelection","idx","e","setState","next","prevState","prev","anyChange","inputName","target","name","inputValue","entries","Object","assign","answer","questionID","undefined","localStorage","setItem","JSON","stringify","filter","frequency","length","completeMode","parse","getItem","index","group","dummieArray","item","push","selectCat","componentDidMount","transportId","modeID","get","API_URL","then","res","data","isLoaded","post","ptoID","parseInt","periodeID","previousPeriod","previousResult","mode_id","sort","a","b","prevFreq","newStateAnswers","render","nextSubmit","pathname","submit","console","log","display","justifyContent","marginRight"],"mappings":"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","sourcesContent":["import Frequency from './Frequency/Radio';\nimport Comments from './Comment/Comment';\n// import Legend from './Legend/Legend';\n// import Motivation from './Motivation/Motivation2'\nimport Categories from './Categories/Categories'\nimport URLStorage from '../../../constants';\nimport { Link } from 'react-router-dom';\n// import  ConfirmModal  from '../Modal';\n\nimport '../../../App.css';\n\nimport axios from 'axios';\nimport React from 'react';\nimport { Container, Row, Col, Button, Form, FormGroup, Label, Input } from 'reactstrap';\n\nimport './MainForm.css'\n\nconst Motivation = props => {\n\n\n    // axios.get(`${URLStorage.API_URL}/getallmotivations`)\n    //         .then(res => {\n    //             this.setState({ motivations: res.data });\n    //             localStorage.setItem(\"motivation\", JSON.stringify(res.data));\n    //         })\n\n    return       <FormGroup>\n    <Label >Motivation</Label>\n    <Input value={props.value} onChange={props.parentCallback}>\n        {/* {props.items.map((motivations, idx) =>\n            <option key={idx} value={motivations.id}>{motivations.motivations}</option>)} */}\n            { this.state.motivations.map(motivations => <option>{motivations.motivation}</option>)}\n    </Input>    \n</FormGroup>\n   \n}\n\nexport default class MainForm extends React.Component {\n\n    state = {\n\n        // --------- TESTING : UNCOMMENT WHEN SERVER DOWN ----------------\n        categories: [],\n        motivations: [],\n        regularity:[],\n        questions: [],\n        questionId: [],\n        id: 2,\n        // ----------------------------------------------------------------\n\n        answers: [],\n        value: [],\n        selectedCat: 1,\n        selectedMode: 0,\n\n    };\n\n    handleSelection = (idx) => (e) => {\n        this.setState({ selectedMode: idx });\n    };\n\n    next = () => {\n        this.setState(prevState => ({ selectedCat: prevState.selectedCat + 1 }));\n    }\n\n    prev = () => {\n        this.setState(prevState => ({ selectedCat: prevState.selectedCat - 1 }));\n    }\n\n    anyChange = (id) => (e) => {\n        const inputName = e.target.name;\n        const inputValue = e.target.value;\n        let entries = Object.assign({}, this.state);\n        const { answers } = entries;\n        answers.map(answer => answer.questionID === id ? answer[inputName] = inputValue : undefined);\n        this.setState(entries);\n        localStorage.setItem(this.props.id, JSON.stringify(this.state.answers));\n\n        // ------------ SWITCH BOOLEAN TO COMPLETED FOR CURRENT MODE ---------------\n      \n        if (this.state.answers.filter(answer => answer.frequency === null).length === 0) {\n            \n            let completeMode = JSON.parse(localStorage.getItem(\"completedModes\"));\n            completeMode[this.props.index] = true;\n            \n            if (this.props.group) {          \n                var dummieArray = [];          \n                    completeMode.map(item => dummieArray.push(true));  \n                    localStorage.setItem(\"completedModes\", JSON.stringify(dummieArray));                      \n                                \n            } else {\n                localStorage.setItem(\"completedModes\", JSON.stringify(completeMode));\n            }            \n        } \n    }\n\n    selectCat = (e) => {\n        this.setState({ selectedCat: e.target.value })\n        localStorage.setItem(this.props.id, JSON.stringify(this.state.answers));\n    }\n\n    componentDidMount() {\n\n        const transportId = this.props.id;\n        this.setState({ modeID: transportId })\n\n\n        // ------------ TESTING : UNCOMMENT WHEN SERVER DOWN -------\n        // const localanswers = localStorage.getItem(this.props.id);\n        // console.log(localanswers);\n        // this.setState({ answers: JSON.parse(localanswers)});\n        // console.log(\"localstorageanswers\", this.state.answers);\n        //-----------------------------------------------------------\n\n\n        // ------------ TESTING : COMMENT WHEN SERVER DOWN -------\n        \n\n        // axios.get(`${URLStorage.API_URL}/getallresult`)\n        //     .then(res => {\n        //         if (res) {\n\n        //             const answers = res.data.map(function (item) {\n        //                 return {\n        //                     // question: item.question,\n        //                     // categoryId: item.id[0],\n        //                     // questionID: item.id[1],\n        //                     // motivationID: 6,\n        //                     // frequency: null,\n        //                     // modeID: transportId,\n        //                     idUser: item.idUser,\n        //                     frequency: item.idFrequency,\n        //                     motivation: item.idMotivation,\n        //                     question: item.idQuestion,\n        //                     comment: \"\",\n        //                     // periode: JSON.parse(localStorage.getItem(\"periods\")).currentPeriod,\n        //                     // previousPeriod: JSON.parse(localStorage.getItem(\"periods\")).previousPeriod,\n        //                 }\n        //             });\n        //             this.setState({ answers });\n        //             localStorage.setItem(this.props.id, JSON.stringify(answers));\n\n        //             if (!localStorage.getItem(this.props.id)) {\n        //                 this.setState({ answers });\n        //                 localStorage.setItem(this.props.id, JSON.stringify(this.state.answers));\n\n        //             } else {\n        //                 let ans1;\n        //                 ans1 = localStorage.getItem(this.props.id);\n        //                 this.setState({ answers: JSON.parse(ans1) });\n        //             }\n        //         }\n        //     })\n        //     .then(() => {\n        //         const localquestions = JSON.parse(localStorage.getItem(\"questions\"));\n        //         this.setState({ questions: localquestions });\n        //         let ans2;\n\n        //         ans2 = localStorage.getItem(this.props.id);\n        //         this.setState({ answers: JSON.parse(ans2) });\n        //     })\n\n        axios.get(`${URLStorage.API_URL}/getallmotivations`)\n            .then(res => {\n                this.setState({ motivations: res.data });\n                localStorage.setItem(\"motivation\", JSON.stringify(res.data));\n            })\n\n       \n\n        axios.get(`${URLStorage.API_URL}/getallincident`)\n            .then(res => {\n                const data = res.data\n                this.setState({\n                    categories: data,\n                    isLoaded: true,\n                })\n            })\n\n        \n\n        \n\n\n        // ------------------ Retreiving PREVIOUS PERIOD RESULTS ----------------------\n\n        if (JSON.parse(localStorage.getItem(\"periods\"))) {\n\n            axios.post(`${URLStorage.API_URL}/resultPeriode`, {\n                ptoID: parseInt(localStorage.getItem(\"ptoid\")),\n                periodeID: JSON.parse(localStorage.getItem(\"periods\")).previousPeriod,\n            })          \n            .then(res => {\n                const previousResult = res.data.filter(item => item.mode_id === transportId).sort((a, b) => a.questionID - b.questionID).map(item => {\n                    \n                    return { prevFreq: item.frequency, };\n                })\n                const newStateAnswers = this.state.answers.map((answer, idx) => {\n                    return { ...answer, ...previousResult[idx] }\n                })\n        // // ------------------ ADDING PREVIOUS PERIOD RESULTS TO THE STATE.ANSWERS ----------------------\n                this.setState({ answers: newStateAnswers });\n                localStorage.setItem(\"prevResult\", JSON.stringify(previousResult))\n            })\n        };\n        // // -----------------------------------------------------------------\n\n\n        axios.get(`${URLStorage.API_URL}/getallfrequency`)\n            .then(res => {\n                const data = res.data\n                this.setState({\n                    regularity: data,\n                    id:[],\n                    isLoaded: true,\n                })\n            })\n\n        \n        axios.get(`${URLStorage.API_URL}/getAllQuestions/${this.state.id}`)\n        .then(res => {\n            const data = res.data\n            this.setState({\n                questions: data,\n                isLoaded: true,\n            })\n        })\n\n       \n        // axios.get(`${URLStorage.API_URL}/getallquestions`)\n        // .then(res => {\n        //     const data = res.data\n        //     this.setState({\n        //         questions: data,\n        //         id:[],\n        //         isLoaded: true,\n        //     })\n        // })\n\n        \n\n    };\n\n\n    render() {\n        // NEXT / SUBMIT BUTTON SWITCH\n        const nextSubmit = this.state.selectedCat === 5 ?\n            // || (parseInt((localStorage.getItem(\"group\")) === 1)\n            (JSON.parse(localStorage.getItem(\"completedModes\")).filter(item => item === false).length === 0)  ?\n                <Link to={{ pathname: \"/confirmation\", state: { answers: this.state.answers } }}>\n                    <Button onClick={this.submit} className=\"submit\">Submit</Button>\n                </Link>\n                : <>\n                    <Button className=\"submit\" disabled>Submit</Button>\n                </>\n            :\n            <Button onClick={this.next} className=\"submit\">Next</Button>;\n\n            \n        // async function getAnswers(){\n        //     const { answers } = await this.state;\n        // }\n\n        // getAnswers();\n        const { answers } = this.state;\n\n        \n        \n\n        //console.log(this.state.categories);\n        // console.log(this.state.regularity);\n        // console.log(this.state.motivations);\n        console.log(this.state.questions);\n        // console.log(this.state.answers);\n        // console.log(this.state);\n\n        return (\n            <React.Fragment>\n                <Container>\n\n                    <div style={{ display: \"flex\", justifyContent: \"flex-end\" }}>\n                        {this.state.selectedCat !== 1 && <Button style={{ marginRight: \"10px\" }} onClick={this.prev} className=\"submit\" >Previous</Button>}\n                        {nextSubmit}\n                    </div>\n                    <Categories categories={this.state.categories} parentCallback={this.selectCat} active={this.state.selectedCat} />\n                    \n                    {/* { this.state.motivations.map(motivations => <li>{motivations.motivation}</li>)} */}\n                    \n                    <Motivation />\n\n                </Container>\n            </React.Fragment>\n        )\n    }\n}\n\n\n"]},"metadata":{},"sourceType":"module"}